 name: keepalive

 on:
   schedule:
     - cron: "*/5 * * * *"
   workflow_dispatch: {}

 jobs:
   ping:
     runs-on: ubuntu-latest
     timeout-minutes: 2
     steps:
       - name: Curl health check
         run: |
-          set -e
-          curl -fsS \
-            --max-time 10 \
-            --retry 3 --retry-delay 2 --retry-all-errors \
-            "https://whkmsalessalary-production.up.railway.app/" > /dev/null
+          set -euo pipefail
+          url="https://whkmsalessalary-production.up.railway.app/_stcore/health"
+          echo "Pinging: $url"
+          code=$(curl -L -sS -o /dev/null -w "%{http_code}" \
+            --max-time 30 \
+            --retry 5 --retry-delay 3 --retry-all-errors \
+            "$url")
+          echo "HTTP: $code"
+          test "$code" = "200"
